import macros
import ../autogenerated/generated_nftnl

const
  StringAttrs* = {NFTNL_RULE_USERDATA}
  Uint32Attrs* = {
    NFTNL_RULE_FAMILY, NFTNL_RULE_TABLE, NFTNL_RULE_CHAIN, NFTNL_RULE_HANDLE,
    NFTNL_RULE_COMPAT_PROTO, NFTNL_RULE_COMPAT_FLAGS,
  }
  Uint64Attrs* = {} # If libnftnl exposes any 64-bit rule attrs, add them here.

template expectedType*(attr: static enum_nftnl_rule_attr): untyped =
  when attr in StringAttrs:
    string
  elif attr in Uint32Attrs:
    uint32
  elif attr in Uint64Attrs:
    uint64
  else:
    {.error: "Unsupported rule attribute: " & $attr.}
