import macros
import ../autogenerated/generated_nftnl

const
  StringAttrs* = {NFTNL_TABLE_NAME, NFTNL_TABLE_USERDATA, NFTNL_TABLE_OWNER}
  Uint32Attrs* = {NFTNL_TABLE_FAMILY, NFTNL_TABLE_FLAGS, NFTNL_TABLE_USE}
  Uint64Attrs* = {NFTNL_TABLE_HANDLE}

# --- type mapping at CT -------------------------------------------------------

template expectedType*(attr: static enum_nftnl_table_attr): untyped =
  when attr in StringAttrs:
    string
  elif attr in Uint32Attrs:
    uint32
  elif attr in Uint64Attrs:
    uint64
  else:
    {.error: "Unsupported table attribute: " & $attr.}
