import macros
import ../autogenerated/generated_nftnl

const
  StringAttrs* = {
    NFTNL_CHAIN_NAME, NFTNL_CHAIN_TABLE, NFTNL_CHAIN_TYPE, NFTNL_CHAIN_DEV,
    NFTNL_CHAIN_USERDATA,
  }

  Uint32Attrs* =
    {NFTNL_CHAIN_FAMILY, NFTNL_CHAIN_HOOKNUM, NFTNL_CHAIN_PRIO, NFTNL_CHAIN_POLICY}

  Uint64Attrs* = {NFTNL_CHAIN_HANDLE}

# --- type mapping at CT -------------------------------------------------------

template expectedType*(attr: static enum_nftnl_chain_attr): untyped =
  when attr in StringAttrs:
    string
  elif attr in Uint32Attrs:
    uint32
  elif attr in Uint64Attrs:
    uint64
  else:
    {.error: "Unsupported chain attribute: " & $attr.}
