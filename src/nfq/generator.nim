{.passC: staticExec("pkg-config --cflags libnetfilter_queue libmnl").}
{.passL: staticExec("pkg-config --libs   libnetfilter_queue libmnl").}

from os import parentDir, `/`
import futhark

when defined(useFuthark):
  const glibcInclude  = staticExec("nix eval --raw nixpkgs#glibc.dev.outPath") & "/include"
  const linuxHdrsRoot = staticExec("nix eval --raw nixpkgs#linuxHeaders")
  const linuxInclude  = linuxHdrsRoot & "/include"
  const nfqInclude    = staticExec("pkg-config --variable=includedir libnetfilter_queue")
  const mnlInclude    = staticExec("pkg-config --variable=includedir libmnl")
  const nfnetlinkInc  = staticExec("pkg-config --variable=includedir libnfnetlink")

  importc:
    outputPath currentSourcePath.parentDir / "autogenerated" / "generated_nfq.nim"
    path linuxInclude
    path nfqInclude
    path mnlInclude
    path nfnetlinkInc
    path glibcInclude

    "libnetfilter_queue/libnetfilter_queue.h"
    "libmnl/libmnl.h"
    "libnfnetlink/libnfnetlink.h"
    "linux/netfilter.h"
    "linux/netfilter/nfnetlink.h"
    "linux/netfilter/nfnetlink_queue.h"
