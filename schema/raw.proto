syntax = "proto3";

message Attr {
  uint32 id = 1;
  bytes data = 2;
}

message Expr {
  uint32 type = 1; // 1 = payload, 2 = cmp
  repeated Attr attrs = 2;
}

message Rule {
  uint32 family = 1;
  string table = 2;
  string chain = 3;
  repeated Expr exprs = 4;
}

message Chain {
  uint32 family = 1;
  string table = 2;
  string name = 3;
  repeated Rule rules = 4;
}

message Table {
  uint32 family = 1;
  string name = 2;
  repeated Chain chains = 3;
}

message Top { repeated Table tables = 1; }
